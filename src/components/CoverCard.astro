---
---

<script type="module">
  import AtroposComponent from "https://unpkg.com/atropos@2.0.2/atropos-element.mjs";
  customElements.define("atropos-component", AtroposComponent);

  class CoverCard extends HTMLElement {
    constructor() {
      super();
      this.attachShadow({ mode: "open" });
    }

    static get styles() {
      return /* css */`
        :host {
          display: block;
          position: absolute;
          inset: 0;
          bottom: -10px;
          background: #0008;
          z-index: 5;
          backdrop-filter: blur(5px);
        }

        atropos-component {
          --size: 512px;

          max-width: var(--size);
          max-height: var(--size);
          position: absolute;
          z-index: 5;
          padding: 0;
          border: 0;
          position: absolute;
          left: calc(50% - var(--size) / 2);
          top: calc(50% - var(--size) / 2);

          & img {
            max-width: var(--size);
            max-height: var(--size);
          }

          /*
          &::before {
            content: "";
            background: url("/cover-texture.jpg");
            width: 100%;
            height: 100%;
            background-size: 1024px 1024px;
            background-position: center;
            mix-blend-mode: screen;
            opacity: 25%;
            position: absolute;

            pointer-events: none;
          }

          &::after {
            content: "";
            width: 100%;
            height: 100%;
            background: radial-gradient(#0000 70%, #000);
            background-size: cover;
            position: absolute;
            mix-blend-mode: overlay;
            z-index: 10;

            pointer-events: none;
          }
          */

          & .img {
            width: 100%;
            height: 100%;
          }
        }
      `;
    }

    connectedCallback() {
      this.image = this.getAttribute("src");
      this.render();
      this.addEventListener("click", () => this.remove());
    }

    render() {
      this.shadowRoot.innerHTML = /* html */`
        <style>${CoverCard.styles}</style>
        <atropos-component>
          <img src="${this.image}" alt="">
        </atropos-component>
      `;
    }
  }

  customElements.define("cover-card", CoverCard);
</script>
